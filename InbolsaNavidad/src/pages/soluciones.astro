---
// src/pages/soluciones.astro
export const prerender = true;

import Base from '../layouts/Base.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

const pageTitle = 'Soluciones';

const introBlocks = [
  {
    title: 'Soluciones personalizadas en rafia',
    text: 'Diseñamos sacos, big bags, telas e hilos con especificaciones a medida para cada industria, optimizando protección, logística y presencia de marca.',
  },
  {
    title: 'Calidad certificada',
    text: 'Procesos auditados, laboratorio propio y trazabilidad completa garantizan estándares nacionales e internacionales en cada lote.',
  },
  {
    title: 'Acompañamiento integral',
    text: 'Desde la ingeniería del embalaje hasta la implementación en planta y el abastecimiento continuo, estamos a tu lado.',
  },
];

// Galerías de imágenes por categoría
const PRODUCT_GALLERIES = {
  'sacos-pp': [
    { url: '/img/productos/Saco Convencional.webp', caption: 'Saco Convencional', category: 'convencional' },
    { url: '/img/productos/Saco Convencional (2).webp', caption: 'Saco Convencional', category: 'convencional' },
    { url: '/img/productos/Saco convencional (3).webp', caption: 'Saco Convencional', category: 'convencional' },
    { url: '/img/productos/Saco convencional con fuelle.webp', caption: 'Saco con Fuelle', category: 'convencional' },
    { url: '/img/productos/Saco fondo cuadrado.webp', caption: 'Saco Fondo Cuadrado', category: 'fondo-cuadrado' },
    { url: '/img/productos/Saco fondo cuadrado 2.webp', caption: 'Saco Fondo Cuadrado', category: 'fondo-cuadrado' },
    { url: '/img/productos/Saco fondo cuadrado 3.webp', caption: 'Saco Fondo Cuadrado', category: 'fondo-cuadrado' },
    { url: '/img/productos/Fondo cuadrado 4.webp', caption: 'Fondo Cuadrado', category: 'fondo-cuadrado' },
    { url: '/img/productos/Fondo cuadrado 5.webp', caption: 'Fondo Cuadrado', category: 'fondo-cuadrado' },
    { url: '/img/productos/saco laminado 3.webp', caption: 'Saco Laminado', category: 'laminado' },
    { url: '/img/productos/Saco laminado 4.webp', caption: 'Saco Laminado', category: 'laminado' },
    { url: '/img/productos/Saco laminado 5.webp', caption: 'Saco Laminado', category: 'laminado' },
    { url: '/img/productos/Saco Laminado 6.webp', caption: 'Saco Laminado', category: 'laminado' },
    { url: '/img/productos/Saco laminado 7.webp', caption: 'Saco Laminado', category: 'laminado' },
    { url: '/img/productos/Saco Laminado 8.webp', caption: 'Saco Laminado', category: 'laminado' },
    { url: '/img/productos/Saco laminado.webp', caption: 'Saco Laminado', category: 'laminado' },
    { url: '/img/productos/Saco Laminado premium.webp', caption: 'Saco Laminado Premium', category: 'premium' },
    { url: '/img/productos/Saco laminado premium 2.webp', caption: 'Saco Laminado Premium', category: 'premium' },
    { url: '/img/productos/Saco laminado premium 3.webp', caption: 'Saco Laminado Premium', category: 'premium' },
    { url: '/img/productos/Saco Laminado premium6.webp', caption: 'Saco Laminado Premium', category: 'premium' },
    { url: '/img/productos/Saco aminado 2.webp', caption: 'Saco Laminado', category: 'laminado' }
  ],
  'big-bag': [
    { url: '/img/productos/Big Bag U panel.webp', caption: 'Big Bag U Panel', category: 'costurado' },
    { url: '/img/productos/Bolsa Convencional con liner.webp', caption: 'Big Bag con Liner', category: 'tubular' },
    { url: '/img/productos/Bolsa Convencional Valvula.webp', caption: 'Big Bag con Válvula', category: 'tubular' },
    { url: '/img/productos/Bolsa Convencional, Liner.webp', caption: 'Big Bag con Liner', category: 'tubular' }
  ],
  'hilos-sogas': [
    { url: '/img/productos/Hilo pp 1.webp', caption: 'Hilo PP', category: 'pp' },
    { url: '/img/productos/Hilo pp 2.webp', caption: 'Hilo PP', category: 'pp' },
    { url: '/img/productos/Hilo pp 3.webp', caption: 'Hilo PP', category: 'pp' },
    { url: '/img/productos/Hilo PP 4.webp', caption: 'Hilo PP', category: 'pp' },
    { url: '/img/productos/Hilo pp 5.webp', caption: 'Hilo PP', category: 'pp' },
    { url: '/img/productos/Hilo pp 6.webp', caption: 'Hilo PP', category: 'pp' },
    { url: '/img/productos/Hilo multifilamento.webp', caption: 'Hilo Multifilamento', category: 'multifilamento' },
    { url: '/img/productos/Hilo Entorcelado pp.webp', caption: 'Hilo Entorchado PP', category: 'entorchado' },
    { url: '/img/productos/Hilo entorcelado multifilamento.webp', caption: 'Hilo Entorchado Multifilamento', category: 'entorchado' }
  ],
  'otros': [
    { url: '/img/productos/Bolsa de Red.webp', caption: 'Bolsa de Red', category: 'red' }
  ]
};

// Catálogo resumido para la vista de tarjetas
const CATALOG = [
  {
    cat: 'Sacos PP',
    items: [
      { id: 'sacos-convencionales', name: 'Sacos Convencionales', img: '/img/productos/Saco Convencional.webp' },
      { id: 'sacos-premium', name: 'Sacos Premium', img: '/img/productos/Saco Laminado premium.webp' },
      { id: 'sacos-fondo-cuadrado', name: 'Sacos Fondo Cuadrado', img: '/img/productos/fondocuadrados.webp' },
    ],
  },
  {
    cat: 'Big Bag',
    items: [
      { id: 'big-bag-linea-costurada', name: 'Big Bag con laterales costurados', img: '/img/productos/bigbagupanel.webp' },
      { id: 'big-bag-tubular', name: 'Big Bag Tubular', img: '/img/productos/bigbagtubular.webp' },
      { id: 'sling-bag', name: 'Sling Bag', img: '/img/productos/slinbag1.webp' },
    ],
  },
  {
    cat: 'Hilos y Sogas',
    items: [
      { id: 'hilo-plano', name: 'Hilo plano', img: '/img/productos/Hilo pp 1.webp' },
      { id: 'hilo-costura', name: 'Hilo de costura', img: '/img/productos/hiloscostura.webp' },
      { id: 'hilo-amarre', name: 'Hilo de amarre', img: '/img/productos/Hilo Entorcelado pp.webp' },
    ],
  },
  {
    cat: 'Telas',
    items: [
      { id: 'tela-tejido', name: 'Tela tejido', img: '/img/productos/tela-plana.webp' },
    ],
  },
];

// Detalle por familia
const FAMILY_DETAILS = [
  {
    id: 'sacos-pp',
    eyebrow: 'Sacos PP',
    title: 'Soluciones para sacos PP',
    products: CATALOG[0].items,
    gallery: PRODUCT_GALLERIES['sacos-pp'],
    description: [
      'Sacos tejidos con opciones de laminado, fondo cuadrado y acabados premium para resaltar la marca en retail o asegurar la cadena logística de agro e industria.',
      'Fabricamos bajo especificación, con impresiones de alta definición y refuerzos para procesos automatizados.',
    ],
    applications: [
      'Sacos convencionales para granos, harinas y balanceados.',
      'Versiones premium para exhibición y productos de alto valor.',
      'Modelos con fondo cuadrado para apilado estable en pallets y estantería.',
    ],
    differentiators: [
      'Tejido de PP virgen con aditivos anti UV.',
      'Costuras reforzadas y sellos ultra controlados.',
      'Microperforado y barrera coex según contenido.',
      'Personalización flexográfica a varios colores.',
    ],
    specs: [
      { label: 'Gramaje', value: '70 a 130 g/m²' },
      { label: 'Capacidades', value: '20 a 50 kg' },
      { label: 'Formatos', value: 'Convencional, premium, fondo cuadrado' },
    ],
  },
  {
    id: 'big-bag',
    eyebrow: 'Big Bag',
    title: 'Soluciones para big bag',
    products: CATALOG[1].items,
    gallery: PRODUCT_GALLERIES['big-bag'],
    description: [
      'Big bags línea costurada, tubulares y sling bag para cargas de 500 a 2.000 kg con factores de seguridad 5:1, 6:1 y 8:1.',
      'Disponibles con liners internos, válvulas de carga/descarga y tratamientos ESD para industrias exigentes.',
    ],
    applications: [
      'Línea costurada para cargas pesadas y reutilización controlada.',
      'Tubular para polvos finos y pigmentos.',
      'Sling bag para logística ágil sin pallets.',
    ],
    differentiators: [
      'Costuras reforzadas y pruebas de tracción certificadas.',
      'Asas en múltiples configuraciones y anchos.',
      'Liners coex, antiestáticos y baffles internos.',
      'Etiquetas, doc pocket y trazabilidad integrada.',
    ],
    specs: [
      { label: 'Capacidad', value: '500 a 2.000 kg' },
      { label: 'Factor de seguridad', value: '5:1 · 6:1 · 8:1' },
      { label: 'Configuraciones', value: 'Costurada, tubular, sling' },
    ],
  },
  {
    id: 'hilos-sogas',
    eyebrow: 'Hilos y sogas',
    title: 'Soluciones en hilos y sogas',
    products: CATALOG[2].items,
    gallery: PRODUCT_GALLERIES['hilos-sogas'],
    description: [
      'Monofilamentos y multifilamentos de polipropileno y poliamida para costura, atado y logística.',
      'Disponibles en bobinas, conos y lazos preformados según el proceso productivo.',
    ],
    applications: [
      'Hilo de costura para sacos de PP y tejido.',
      'Hilo reforzado para cargas exigentes y alta vibración.',
      'Amarres y sogas para transporte, campo y fardos.',
    ],
    differentiators: [
      'Resistencia certificada con baja elongación.',
      'Lubricación específica para máquinas de alta velocidad.',
      'Opciones antiestáticas y tratamiento UV.',
    ],
    specs: [
      { label: 'Títulos', value: '840 a 3200 den' },
      { label: 'Presentación', value: 'Conos 1–5 kg · Bobinas 2–6 kg' },
      { label: 'Aplicaciones', value: 'Costura, atado, logística' },
    ],
  },
  {
    id: 'telas',
    eyebrow: 'Telas',
    title: 'Soluciones en telas tejidas',
    products: CATALOG[3].items,
    gallery: PRODUCT_GALLERIES['otros'],
    description: [
      'Tela tejido de rafia PP para conversión, protección y recubrimiento en procesos industriales.',
      'Control de gramaje, anchos y tratamientos superficiales según requerimiento.',
    ],
    applications: [
      'Confección de sacos industriales.',
      'Revestimiento de estructuras y protección de carga.',
    ],
    differentiators: [
      'Gramajes calibrados con tolerancia ±3%.',
      'Tratamientos anti UV, antideslizante y corona opcionales.',
      'Entrega en rollos con mandril, plegados o cortes a medida.',
    ],
    specs: [
      { label: 'Anchos', value: 'Hasta 320 cm' },
      { label: 'Presentación', value: 'Rollo tejido' },
    ],
  },
];
---

<Base title={pageTitle}>
  <Header/>

  <!-- Estilos para tabs interactivos -->
  <style>
    .tab-content { display: none; }
    .tab-content.active { display: block; animation: fadeIn 0.4s ease-in; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .tab-button { position: relative; transition: all 0.3s ease; }
    .tab-button::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, #3e7dd2, #2f65b0); transform: scaleX(0); transition: transform 0.3s ease; border-radius: 3px 3px 0 0; }
    .tab-button.active::after { transform: scaleX(1); }
    .tab-button.active { color: #3e7dd2; font-weight: 600; }
    .glass-card { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); }
    .product-card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
    .product-card:hover { transform: translateY(-8px) scale(1.02); box-shadow: 0 20px 40px rgba(62, 125, 210, 0.2); }
    .icon-box { background: linear-gradient(135deg, #3e7dd2 0%, #2f65b0 100%); box-shadow: 0 4px 15px rgba(62, 125, 210, 0.3); }

    /* Efecto zoom modal para productos */
    .product-card-hover { overflow: visible !important; }
    .product-card-hover:hover { z-index: 100; transform: scale(1.05); }

    @keyframes zoomIn {
      from {
        opacity: 0;
        transform: scale(0.8) translateY(-10px);
      }
      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }

    .zoom-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90vw;
      max-width: 600px;
      height: auto;
      max-height: 80vh;
      z-index: 9999;
      animation: zoomIn 0.3s ease-out;
    }

    @keyframes scale-in {
      from {
        opacity: 0;
        transform: scale(0.95);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .animate-scale-in {
      animation: scale-in 0.3s ease-out;
    }
  </style>

  <main class="bg-gradient-to-b from-white via-red-50/30 to-white">
    <!-- Hero Section Mejorado -->
    <section class="relative overflow-hidden bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900">
      <!-- Patrón de fondo animado -->
      <div class="absolute inset-0 opacity-10">
        <div class="absolute inset-0" style="background-image: radial-gradient(circle at 2px 2px, white 1px, transparent 0); background-size: 40px 40px;"></div>
      </div>

      <!-- Círculos decorativos animados - SOLO DESKTOP -->
      <div class="hidden md:block absolute top-20 -left-20 w-96 h-96 bg-red-500/20 rounded-full blur-2xl opacity-50 animate-pulse"></div>
      <div class="hidden md:block absolute bottom-20 -right-20 w-96 h-96 bg-red-400/20 rounded-full blur-2xl opacity-50 animate-pulse" style="animation-delay: 1s;"></div>

      <div class="relative mx-auto max-w-7xl px-4 py-16 md:py-24 lg:py-32">
        <div class="text-center">
          <!-- Badge moderno -->
          <div class="inline-flex items-center gap-3 rounded-full bg-gradient-to-r from-red-500/20 to-sky-500/20 backdrop-blur-xl border border-white/30 px-6 py-3 text-sm text-white shadow-lg">
            <span class="relative flex h-3 w-3">
              <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
              <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500 shadow-lg shadow-red-500/50"></span>
            </span>
            <span class="font-medium">Productos de Alto Rendimiento</span>
          </div>

          <!-- Título principal mejorado -->
          <h1 class="mt-6 md:mt-8 text-3xl md:text-5xl lg:text-7xl font-black tracking-tight text-white leading-tight">
            Nuestras
            <span class="block mt-2 md:mt-3 bg-gradient-to-r from-red-300 via-red-400 to-red-500 bg-clip-text text-transparent drop-shadow-lg">
              Soluciones
            </span>
          </h1>

          <!-- Descripción mejorada -->
          <p class="mt-6 md:mt-8 text-base md:text-xl lg:text-2xl text-white/90 max-w-3xl mx-auto leading-relaxed font-light">
            Embalaje industrial de <strong class="font-semibold text-red-300">polipropileno</strong> que protege, optimiza y potencia tu marca
          </p>

          <!-- Botones mejorados -->
          <div class="mt-12 flex flex-wrap justify-center gap-5">
            <a href="#productos"
               class="group relative inline-flex items-center gap-3 rounded-2xl bg-gradient-to-r from-red-600 to-red-700 px-10 py-5 text-white font-semibold hover:from-red-700 hover:to-red-800 transition-all hover:scale-105 shadow-2xl shadow-red-500/30 overflow-hidden">
              <span class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></span>
              <span class="relative">Explorar Productos</span>
              <svg class="relative w-5 h-5 group-hover:translate-x-2 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
              </svg>
            </a>
            <a href="/contacto"
               class="inline-flex items-center gap-3 rounded-2xl border-2 border-white/40 bg-white/10 backdrop-blur-xl px-10 py-5 text-white font-semibold hover:bg-white/20 hover:border-white/60 transition-all hover:scale-105 shadow-xl">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
              </svg>
              Contáctanos
            </a>
          </div>

          <!-- Estadísticas o badges -->
          <div class="mt-16 flex flex-wrap justify-center gap-8 text-white/80">
            <div class="text-center">
              <div class="text-3xl font-bold text-white">+30</div>
              <div class="text-sm mt-1">Años de experiencia</div>
            </div>
            <div class="w-px bg-white/20"></div>
            <div class="text-center">
              <div class="text-3xl font-bold text-white">4</div>
              <div class="text-sm mt-1">Familias de productos</div>
            </div>
            <div class="w-px bg-white/20"></div>
            <div class="text-center">
              <div class="text-3xl font-bold text-white">100%</div>
              <div class="text-sm mt-1">Calidad certificada</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Wave divisor mejorado -->
      <div class="absolute bottom-0 left-0 right-0">
        <svg viewBox="0 0 1440 120" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-full">
          <path d="M0 0L60 10C120 20 240 40 360 46.7C480 53.3 600 46.7 720 43.3C840 40 960 40 1080 43.3C1200 46.7 1320 53.3 1380 56.7L1440 60V120H1380C1320 120 1200 120 1080 120C960 120 840 120 720 120C600 120 480 120 360 120C240 120 120 120 60 120H0V0Z" fill="white" fill-opacity="0.1"/>
          <path d="M0 40L60 46.7C120 53.3 240 66.7 360 70C480 73.3 600 66.7 720 63.3C840 60 960 60 1080 63.3C1200 66.7 1320 73.3 1380 76.7L1440 80V120H1380C1320 120 1200 120 1080 120C960 120 840 120 720 120C600 120 480 120 360 120C240 120 120 120 60 120H0V40Z" fill="white"/>
        </svg>
      </div>
    </section>

    <!-- Hero visual con imágenes destacadas -->
    <section class="relative mx-auto max-w-7xl px-4 md:px-6 py-12 md:py-20">
      <div class="grid md:grid-cols-2 gap-8 md:gap-12 items-center">
        <!-- Imagen izquierda -->
        <div class="group relative overflow-hidden rounded-3xl shadow-2xl">
          <img
            src="/img/colors/45.webp"
            alt="Productos Inbolsa"
            class="w-full h-[400px] md:h-[500px] object-cover transition-transform duration-700 group-hover:scale-105"
            loading="lazy"
          />
          <div class="absolute inset-0 bg-gradient-to-t from-slate-900/80 via-slate-900/40 to-transparent"></div>
          <div class="absolute bottom-8 left-8 right-8 text-white">
            <h3 class="text-2xl md:text-3xl font-bold mb-2">Soluciones versátiles</h3>
            <p class="text-white/90">Para cada industria y necesidad</p>
          </div>
        </div>

        <!-- Imagen derecha -->
        <div class="group relative overflow-hidden rounded-3xl shadow-2xl">
          <img
            src="/img/colors/85.webp"
            alt="Calidad Inbolsa"
            class="w-full h-[400px] md:h-[500px] object-cover transition-transform duration-700 group-hover:scale-105"
            loading="lazy"
          />
          <div class="absolute inset-0 bg-gradient-to-t from-red-900/80 via-red-900/40 to-transparent"></div>
          <div class="absolute bottom-8 left-8 right-8 text-white">
            <h3 class="text-2xl md:text-3xl font-bold mb-2">Calidad garantizada</h3>
            <p class="text-white/90">50 años de experiencia</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Sistema de TABS interactivo para productos -->
    <section id="productos" class="mx-auto max-w-7xl px-6 py-12 md:py-16 lg:py-20">
      <div class="text-center mb-12">
        <span class="inline-block px-4 py-2 rounded-full bg-gradient-to-r from-red-100 to-sky-100 text-red-700 text-sm font-semibold mb-4">
          Catálogo completo
        </span>
        <h2 class="text-4xl md:text-5xl font-bold text-slate-900 mb-4">
          Explora nuestras
          <span class="text-red-600"> familias de productos</span>
        </h2>
        <p class="text-lg text-slate-600 max-w-2xl mx-auto">
          Selecciona una categoría para conocer todos los detalles técnicos y aplicaciones
        </p>
      </div>

      <!-- Tabs Navigation - Sticky -->
      <nav class="sticky top-20 md:top-24 z-20 mb-12 -mx-6">
        <div class="rounded-2xl border border-slate-200 bg-white/95 shadow-sm backdrop-blur-sm py-4 px-6">
          <div class="flex flex-wrap justify-center gap-3 max-w-4xl mx-auto">
            {FAMILY_DETAILS.map((familia, idx) => (
              <button
                onclick={`switchTab('tab-${idx}')`}
                id={`btn-tab-${idx}`}
                class={`tab-button px-6 py-3 rounded-xl text-sm font-semibold uppercase transition-all shadow-sm hover:shadow-md ${idx === 0 ? 'active bg-red-50 text-red-600 border-2 border-red-200' : 'text-slate-600 hover:bg-slate-50 border-2 border-transparent'}`}
              >
                {familia.eyebrow}
              </button>
            ))}
          </div>
        </div>
      </nav>

      <!-- Tabs Content -->
      <div class="relative">
        {FAMILY_DETAILS.map((familia, index) => (
          <div id={`tab-${index}`} class={`tab-content ${index === 0 ? 'active' : ''}`}>
            <div class="space-y-10">

              <!-- Contenido principal -->
              <div class="space-y-8">
                <!-- Header de la familia -->
                <div class="relative rounded-3xl bg-gradient-to-br from-red-600 to-red-700 p-8 md:p-10 text-white shadow-2xl overflow-hidden">
                  <div class="absolute top-0 right-0 w-40 h-40 bg-white/10 rounded-full blur-2xl"></div>
                  <div class="absolute bottom-0 left-0 w-32 h-32 bg-white/10 rounded-full blur-2xl"></div>

                  <div class="relative">
                    <span class="inline-block px-3 py-1 rounded-full bg-white/20 text-xs font-semibold uppercase tracking-wider mb-4">
                      {familia.eyebrow}
                    </span>
                    <h3 class="text-3xl md:text-4xl font-bold mb-4">{familia.title}</h3>
                    <div class="space-y-3 text-white/90">
                      {familia.description.map((paragraph) => (
                        <p class="leading-relaxed">{paragraph}</p>
                      ))}
                    </div>
                  </div>
                </div>

                <!-- Aplicaciones y Diferenciales -->
                <div class="grid gap-6 md:grid-cols-2">
                  <!-- Aplicaciones -->
                  <div class="group rounded-2xl border-2 border-red-200 bg-white shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden">
                    <div class="bg-gradient-to-r from-red-500 to-red-600 px-6 py-4">
                      <div class="flex items-center gap-3 text-white">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                        </svg>
                        <h4 class="text-lg font-bold uppercase tracking-wide">Aplicaciones clave</h4>
                      </div>
                    </div>
                    <ul class="space-y-3 px-6 py-5">
                      {familia.applications.map((item) => (
                        <li class="flex items-start gap-3 text-slate-700">
                          <span class="mt-1.5 h-2 w-2 flex-shrink-0 rounded-full bg-red-500"></span>
                          <span class="text-sm leading-relaxed">{item}</span>
                        </li>
                      ))}
                    </ul>
                  </div>

                  <!-- Diferenciales -->
                  <div class="group rounded-2xl border-2 border-sky-200 bg-white shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden">
                    <div class="bg-gradient-to-r from-sky-500 to-sky-600 px-6 py-4">
                      <div class="flex items-center gap-3 text-white">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/>
                        </svg>
                        <h4 class="text-lg font-bold uppercase tracking-wide">Diferenciales</h4>
                      </div>
                    </div>
                    <ul class="space-y-3 px-6 py-5">
                      {familia.differentiators.map((item) => (
                        <li class="flex items-start gap-3 text-slate-700">
                          <span class="mt-0.5 inline-flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-gradient-to-br from-sky-500 to-sky-600 text-xs font-bold text-white shadow-md">
                            ★
                          </span>
                          <span class="text-sm leading-relaxed">{item}</span>
                        </li>
                      ))}
                    </ul>
                  </div>
                </div>

              </div>

              <!-- Productos horizontales debajo -->
              <div class="space-y-6">
                <div class="rounded-3xl border-2 border-slate-200 bg-white shadow-xl overflow-hidden">
                  <div class="bg-gradient-to-r from-slate-700 to-slate-800 px-6 py-5">
                    <h4 class="text-white text-lg font-bold uppercase tracking-wide flex items-center gap-2">
                      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                      </svg>
                      Productos disponibles
                    </h4>
                    <p class="text-white/70 text-sm mt-1">{familia.products.length} productos en esta familia</p>
                  </div>

                  <div class={`px-8 py-10 ${familia.products.length === 1 ? 'flex justify-center' : familia.products.length === 3 ? 'grid grid-cols-1 sm:grid-cols-3 gap-6 max-w-4xl mx-auto' : 'grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-6'}`}>
                    {familia.products.map((product, idx) => (
                      <article
                        class={`product-card-hover group rounded-2xl border-2 border-slate-200 bg-white hover:border-red-300 overflow-hidden shadow-md hover:shadow-xl cursor-pointer relative transition-all duration-300 hover:-translate-y-2 ${familia.products.length === 1 ? 'max-w-sm w-full' : ''}`}
                        onclick={`openProductModal('${product.id}-${idx}')`}
                      >
                        <div class="aspect-square w-full overflow-hidden bg-slate-50 relative">
                          <img src={product.img} alt={product.name} class="h-full w-full object-cover group-hover:scale-110 transition-transform duration-500" loading="lazy" />
                          <!-- Overlay con ícono -->
                          <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end justify-center pb-6">
                            <div class="bg-white/95 backdrop-blur-sm rounded-full p-3 shadow-lg">
                              <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                              </svg>
                            </div>
                          </div>
                        </div>
                        <div class="p-4 bg-white min-h-[60px] flex items-center justify-center">
                          <h5 class="font-bold text-sm text-center text-slate-900 group-hover:text-red-600 transition-colors leading-tight">{product.name}</h5>
                        </div>
                      </article>
                    ))}
                  </div>
                </div>

                <!-- CTA Contact -->
                <div class="rounded-2xl bg-gradient-to-br from-red-600 to-red-700 p-6 md:p-8 text-white shadow-xl">
                  <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                    <div>
                      <h5 class="text-xl font-bold mb-2">¿Necesitas asesoría personalizada?</h5>
                      <p class="text-white/90">Nuestro equipo está listo para ayudarte a encontrar la solución perfecta</p>
                    </div>
                    <a href="/contacto" class="flex-shrink-0 bg-white text-red-600 font-semibold px-8 py-3 rounded-xl hover:bg-red-50 transition-colors shadow-lg whitespace-nowrap">
                      Contáctanos ahora
                    </a>
                  </div>
                </div>
              </div>

            </div>
          </div>
        ))}
      </div>
    </section>

    <!-- Modal Detallado de Producto -->
    <div id="product-detail-modal" class="fixed inset-0 z-[9999] hidden">
      <!-- Backdrop -->
      <div class="absolute inset-0 bg-black/70 backdrop-blur-sm" onclick="closeProductModal()"></div>

      <!-- Modal Container -->
      <div class="absolute inset-0 overflow-y-auto bg-white md:bg-transparent">
        <div class="min-h-full flex items-stretch md:items-center justify-center p-0 md:p-4">
          <div class="relative bg-white w-full md:rounded-3xl shadow-2xl max-w-7xl min-h-full md:min-h-0 md:max-h-[95vh] overflow-hidden animate-scale-in">

            <!-- Header del Modal -->
            <div class="sticky top-0 bg-gradient-to-r from-red-600 to-red-700 px-4 py-4 md:px-6 md:py-5 flex items-center justify-between z-10 shadow-lg">
              <h3 id="modal-product-title" class="text-base md:text-xl lg:text-2xl font-bold text-white pr-2">Nombre del Producto</h3>
              <button onclick="closeProductModal()" class="text-white hover:bg-white/20 rounded-full p-2 transition-colors flex-shrink-0">
                <svg class="w-5 h-5 md:w-6 md:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
              </button>
            </div>

            <!-- Contenido del Modal -->
            <div class="overflow-y-auto max-h-[calc(100vh-60px)] md:max-h-[calc(95vh-80px)]">
              <div class="flex flex-col lg:grid lg:grid-cols-[550px_1fr] gap-0">

                <!-- Carrusel de imágenes -->
                <div class="bg-slate-50 lg:border-r border-slate-200 lg:sticky lg:top-0 h-[350px] md:h-[450px] lg:h-[600px] flex flex-col flex-shrink-0">
                  <!-- Imagen principal del carrusel -->
                  <div class="flex-1 flex items-center justify-center p-6 md:p-8 relative overflow-hidden">
                    <img id="modal-carousel-img" src="" alt="" class="w-full h-full object-contain" />

                    <!-- Botones de navegación del carrusel -->
                    <button
                      id="carousel-prev"
                      onclick="changeCarouselImage(-1)"
                      class="bg-red-600 hover:bg-red-700 text-white shadow-2xl rounded-full p-3 md:p-4 transition-all hover:scale-110 active:scale-95 disabled:opacity-30 disabled:cursor-not-allowed z-20"
                      style="visibility: hidden; position: absolute; left: 0.5rem; top: 50%; transform: translateY(-50%) !important;"
                      aria-label="Imagen anterior"
                    >
                      <svg class="w-6 h-6 md:w-7 md:h-7" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
                      </svg>
                    </button>
                    <button
                      id="carousel-next"
                      onclick="changeCarouselImage(1)"
                      class="bg-red-600 hover:bg-red-700 text-white shadow-2xl rounded-full p-3 md:p-4 transition-all hover:scale-110 active:scale-95 disabled:opacity-30 disabled:cursor-not-allowed z-20"
                      style="visibility: hidden; position: absolute; right: 0.5rem; top: 50%; transform: translateY(-50%) !important;"
                      aria-label="Imagen siguiente"
                    >
                      <svg class="w-6 h-6 md:w-7 md:h-7" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
                      </svg>
                    </button>

                    <!-- Contador de imágenes - Mejorado -->
                    <div id="carousel-counter" class="absolute top-3 md:top-4 right-3 md:right-4 bg-black/70 backdrop-blur-md text-white text-xs md:text-sm font-bold px-3 md:px-4 py-1.5 md:py-2 rounded-full shadow-lg border border-white/20 z-10" style="visibility: hidden;">
                      <span id="current-image">1</span> / <span id="total-images">1</span>
                    </div>
                  </div>

                  <!-- Caption debajo de la imagen -->
                  <div class="bg-white border-t border-slate-200 px-3 md:px-4 py-2 md:py-3 min-h-[40px] md:min-h-[50px] flex items-center justify-center">
                    <p id="modal-image-caption" class="text-center text-slate-700 font-medium text-xs md:text-sm line-clamp-2"></p>
                  </div>

                  <!-- Thumbnails del carrusel -->
                  <div id="carousel-thumbnails" class="bg-white border-t border-slate-200 px-3 md:px-4 py-2 md:py-3 overflow-x-auto h-16 md:h-20 flex-shrink-0" style="display: none;">
                    <div class="flex gap-2 h-full" id="thumbnails-container">
                      <!-- Se llenarán dinámicamente -->
                    </div>
                  </div>
                </div>

                <!-- Contenido a la derecha -->
                <div class="p-4 md:p-6 lg:p-8 space-y-3 md:space-y-5 lg:space-y-6 bg-white">

                  <!-- Descripción -->
                  <div>
                    <h4 class="text-xs md:text-sm uppercase tracking-wider text-red-600 font-semibold mb-2 md:mb-3">DESCRIPCIÓN</h4>
                    <p id="modal-product-description" class="text-slate-700 leading-relaxed text-sm md:text-base"></p>
                  </div>

                  <!-- Propiedades -->
                  <div>
                    <h4 class="text-base md:text-lg font-bold text-slate-900 mb-3 md:mb-4 flex items-center gap-2">
                      <svg class="w-4 h-4 md:w-5 md:h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
                      </svg>
                      Propiedades
                    </h4>
                    <div id="modal-product-features" class="grid grid-cols-1 md:grid-cols-2 gap-2 md:gap-3">
                      <!-- Se llenará dinámicamente -->
                    </div>
                  </div>

                  <!-- Industrias -->
                  <div>
                    <h4 class="text-base md:text-lg font-bold text-slate-900 mb-3 md:mb-4 flex items-center gap-2">
                      <svg class="w-4 h-4 md:w-5 md:h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                      </svg>
                      Industrias
                    </h4>
                    <div id="modal-product-uses" class="grid grid-cols-1 md:grid-cols-2 gap-2 md:gap-3">
                      <!-- Se llenará dinámicamente -->
                    </div>
                  </div>

                  <!-- CTA -->
                  <div class="bg-gradient-to-r from-red-50 to-sky-50 rounded-xl md:rounded-2xl p-4 md:p-6 border-2 border-red-200">
                    <div class="flex flex-col items-start md:flex-row md:items-center justify-between gap-3 md:gap-4">
                      <div>
                        <h5 class="font-bold text-slate-900 text-base md:text-lg mb-1">¿Interesado en este producto?</h5>
                        <p class="text-slate-600 text-xs md:text-sm">Contáctanos para más información y cotizaciones</p>
                      </div>
                      <a href="/contacto" class="w-full md:w-auto text-center bg-red-600 hover:bg-red-700 text-white font-semibold px-6 md:px-8 py-3 rounded-xl transition-colors shadow-lg whitespace-nowrap">
                        Solicitar cotización
                      </a>
                    </div>
                  </div>

                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>

    <!-- Script para modal de productos -->
    <script is:inline>
      // Mapeo exacto de nombres a rutas de íconos (nombres tal cual están en archivos)
      const ICON_MAP = {
        // Características de productos (nombres de features usados en PRODUCT_DATA)
        'Valvulado': '/img/icons/Productos/Valvula (Small).PNG',
        'Fuelle': '/img/icons/Productos/Fuelle (Small).PNG',
        'Costuras personalizables': '/img/icons/Productos/Costura personalizable (Small).PNG',
        'Impresiones': '/img/icons/Productos/Impression (Small).PNG',
        'Asas': '/img/icons/Productos/Asas (Small).PNG',
        'Con Liner/ponchillo interno': '/img/icons/Productos/Bolsillo de plastico (Small).PNG',
        'Tela transparente': '/img/icons/Productos/Tela Plana (Small).PNG',
        'Impresión premium': '/img/icons/Productos/Impression premium (Small).PNG',
        'Transparencia cristalina': '/img/icons/Productos/Termino Brillante (Small).PNG',
        'Fondo cuadrado': '/img/icons/Productos/Fondo y superior cuadrado (Small).PNG',
        'Productos premium': '/img/icons/Productos/Impression premium (Small).PNG',
        'Alta resistencia': '/img/icons/Productos/Alta resistencia (Small).PNG',
        'Micro perforación': '/img/icons/Productos/Ventilacion (Small).PNG',
        'Block bottom': '/img/icons/Productos/Fondo y superior cuadrado (Small).PNG',
        'Impresión': '/img/icons/Productos/Impression (Small).PNG',
        'Válvula': '/img/icons/Productos/Valvula (Small).PNG',
        'Laminación': '/img/icons/Productos/Laminacion (Small).PNG',
        'UV': '/img/icons/Productos/Proteccion UV (Small).PNG',
        'Liner': '/img/icons/Productos/Bolsillo de plastico (Small).PNG',
        'Ventilado': '/img/icons/Productos/Ventilacion (Small).PNG',
        'Multiway': '/img/icons/Productos/Multiway (Small).PNG',
        'One Way': '/img/icons/Productos/One way (Small).PNG',
        'Bolsillo para identificación': '/img/icons/Productos/Bolsillo de plastico (Small).PNG',
        'Reforzado': '/img/icons/Productos/Reforzado (Small).PNG',
        'Práctica': '/img/icons/Productos/Lijero (Small).PNG',
        'Económica': '/img/icons/Productos/Lijero (Small).PNG',
        'Conveniente': '/img/icons/Productos/Lijero (Small).PNG',
        'Durable': '/img/icons/Productos/Alta resistencia (Small).PNG',
        'Resistente': '/img/icons/Productos/Alta resistencia (Small).PNG',
        'Ligero': '/img/icons/Productos/Lijero (Small).PNG',
        'Resistente a factores ambientales': '/img/icons/Productos/Resistente a agua (Small).PNG',
        'Multiuso': '/img/icons/Productos/Multiway (Small).PNG',
        'Superior rendimiento': '/img/icons/Productos/Alta resistencia (Small).PNG',
        'Polipropileno': '/img/icons/Productos/Tela tubular (Small).PNG',
        'Multifilamento': '/img/icons/Productos/Tela tubular (Small).PNG',
        'Suave': '/img/icons/Productos/Termino Brillante (Small).PNG',

        // Usos (nombres de uses usados en PRODUCT_DATA)
        'Azúcar': '/img/icons/Usos/Azucar (Small).PNG',
        'Harina/agro': '/img/icons/Usos/Harina (Small).png',
        'Soya': '/img/icons/Usos/Soya (Small).PNG',
        'Metales preciosos, minerías': '/img/icons/Usos/Metales preciosos (Small).PNG',
        'Granos': '/img/icons/Usos/Granos (Small).PNG',
        'Petroquímicos': '/img/icons/Usos/Petroquimicos (Small).PNG',
        'Ganadería/suplementos': '/img/icons/Usos/Ganaderia (Small).PNG',
        'Cemento': '/img/icons/Usos/Cemento (Small).PNG',
        'Semillas': '/img/icons/Usos/Semillas (Small).PNG',
        'Construcción': '/img/icons/Usos/Construccion (Small).PNG',
        'Agro premium': '/img/icons/Usos/Agro premium (Small).PNG',
        'Comida de mascotas': '/img/icons/Usos/Comida de masacotas (Small).PNG',
        'Empolvados/harina': '/img/icons/Usos/Harina (Small).png',
        'Alimentos': '/img/icons/Usos/Alimentos (Small).png',
        'Metales preciosos': '/img/icons/Usos/Metales preciosos (Small).PNG',
        'Amarre': '/img/icons/Usos/Amarre (Small).png',
        'Costura': '/img/icons/Usos/Costura (Small).PNG',
        'Troquelado': '/img/icons/Usos/Construccion (Small).PNG',
        'Ganadería': '/img/icons/Usos/Ganaderia (Small).PNG',
        'Agronomía': '/img/icons/Usos/Fertilizador (Small).PNG',
        'Embalaje': '/img/icons/Usos/Embalage (Small).PNG',
        'Agroindustria': '/img/icons/Usos/Harina (Small).png',
        'Almacenaje': '/img/icons/Usos/Almacenaje (Small).PNG',
        'Industria de manufactura': '/img/icons/Usos/Construccion (Small).PNG'
      };

      // Base de datos de productos con toda la información
      const PRODUCT_DATA = {
        'sacos-convencionales': {
          name: 'Sacos Convencionales',
          description: 'Nuestros sacos están construidos con resiliencia y protección en mente, brindando la solución perfecta para su industria. Desde nuestra línea de yutes para productos agronómicos, sacos planos sirviendo a las minerías, tenemos bolsas para una gran variedad de aplicaciones ofreciendo el producto perfecto para su industria.',
          features: ['Valvulado', 'Fuelle', 'Costuras personalizables', 'Impresiones', 'Asas', 'Con Liner/ponchillo interno', 'Tela transparente'],
          uses: ['Azúcar', 'Harina/agro', 'Soya', 'Metales preciosos, minerías', 'Granos', 'Petroquímicos', 'Ganadería/suplementos', 'Cemento', 'Semillas', 'Construcción'],
          gallery: [
            { url: '/img/productos/Saco Convencional.webp', caption: 'Saco Convencional' },
            { url: '/img/productos/Saco Convencional (2).webp', caption: 'Saco Convencional' },
            { url: '/img/productos/Saco convencional (3).webp', caption: 'Saco Convencional' },
            { url: '/img/productos/Saco convencional con fuelle.webp', caption: 'Saco con Fuelle' }
          ]
        },
        'sacos-premium': {
          name: 'Sacos Premium',
          description: 'Sacos que se destacan por su impresión de alta calidad y resistencia para destacar su producto en el mercado. Se puede asegurar que el saco se pueda adecuar a cualquier necesidad y particularidad de su industria.',
          features: ['Impresión premium', 'Transparencia cristalina', 'Costuras personalizables', 'Fondo cuadrado', 'Productos premium', 'Alta resistencia', 'Micro perforación'],
          uses: ['Agro premium', 'Comida de mascotas'],
          gallery: [
            { url: '/img/productos/Saco Laminado premium.webp', caption: 'Saco Laminado Premium' },
            { url: '/img/productos/Saco laminado premium 2.webp', caption: 'Saco Laminado Premium' },
            { url: '/img/productos/Saco laminado premium 3.webp', caption: 'Saco Laminado Premium' },
            { url: '/img/productos/Saco Laminado premium6.webp', caption: 'Saco Laminado Premium' },
            { url: '/img/productos/saco laminado 3.webp', caption: 'Saco Laminado' },
            { url: '/img/productos/Saco laminado 4.webp', caption: 'Saco Laminado' },
            { url: '/img/productos/Saco laminado 5.webp', caption: 'Saco Laminado' }
          ]
        },
        'sacos-fondo-cuadrado': {
          name: 'Sacos Fondo Cuadrado',
          description: 'La nueva adición de nuestra línea de productos, nuestras bolsas con fondo cuadrado están desarrollados con tecnología de punta. Se destaca por su presentación premium y destacándose en su facilidad de embalaje. Particularmente efectivo con productos en polvo (cemento o harina).',
          features: ['Block bottom', 'Impresión', 'Válvula'],
          uses: ['Cemento', 'Empolvados/harina'],
          gallery: [
            { url: '/img/productos/Saco fondo cuadrado 1.webp', caption: 'Saco Fondo Cuadrado' },
            { url: '/img/productos/Saco fondo cuadrado 2.webp', caption: 'Saco Fondo Cuadrado' },
            { url: '/img/productos/Saco fondo cuadrado 3.webp', caption: 'Saco Fondo Cuadrado' },
            { url: '/img/productos/Fondo cuadrado 4.webp', caption: 'Fondo Cuadrado' },
            { url: '/img/productos/Fondo cuadrado 5.webp', caption: 'Fondo Cuadrado' },
            { url: '/img/productos/fondocuadrados.webp', caption: 'Fondo Cuadrado' }

          ]
        },
        'big-bag-linea-costurada': {
          name: 'Big Bag Línea Costurada',
          description: 'Bolsa construidos con forma en mente, nuestros bolsones big bag costurados están tejidas con cuidado para ofrecer una solución eficiente y reforzado. Tenemos múltiples opciones adecuados para el manejo de su producto con múltiples diseños disponibles.',
          features: ['Laminación', 'UV', 'Liner', 'Ventilado', 'Multiway', 'Alta resistencia', 'Impresión', 'Bolsillo para identificación', 'Reforzado'],
          uses: ['Alimentos', 'Soya', 'Semillas', 'Petroquímicos', 'Ganadería/suplementos', 'Metales preciosos'],
          gallery: [
            { url: '/img/productos/bigbagupanel.webp', caption: 'Big Bag U Panel' },
            { url: '/img/productos/bigbagcuadripanel.webp', caption: 'Big Bag Cuadripanel' },
            { url: '/img/productos/bigbagcompartimentada.webp', caption: 'Big Bag Compartimentada' },
            { url: '/img/productos/Big bag copartimentado apilado .webp', caption: 'Big Bag Compartimentado Apilado' },
            { url: '/img/productos/big bag compartimentado apilado 2.webp', caption: 'Big Bag Compartimentado Apilado' }
            
          ]
        },
        'big-bag-tubular': {
          name: 'Big Bag Tubular',
          description: 'Nuestro big bag mas versátil para productos en bulto ideal para productos en grano. Ofrece seguridad, agilidad, versatilidad, y eficiencia con fuerza superior. Se destaca por su facilidad de almacenaje con la posibilidad de apilar en cantidades altas.',
          features: ['Laminación', 'UV', 'Liner', 'Ventilado', 'One Way', 'Multiway', 'Alta resistencia', 'Impresión'],
          uses: ['Azúcar', 'Harina/agro', 'Metales preciosos, minerías', 'Granos', 'Petroquímicos', 'Ganadería/suplementos', 'Cemento', 'Semillas', 'Construcción'],
          gallery: [
            { url: '/img/productos/bigbagtubular.webp', caption: 'Big Bag Tubular' }
          ]
        },
        'sling-bag': {
          name: 'Sling Bag',
          description: 'Nuestra solución Sling bag es nuestra solución más versátil, remplazando pallets de madera con una solución más practica y ligera. Agiliza descarga y el movimiento de los productos en el momento de almacenaje de transporte.',
          features: ['Práctica', 'Económica', 'Conveniente', 'Durable', 'Resistente'],
          uses: ['Almacenaje', 'Embalaje'],
          gallery: [
            { url: '/img/productos/Sling bag 1.webp', caption: 'Sling Bag' },
            { url: '/img/productos/Slingbag 2.webp', caption: 'Sling Bag' },
            { url: '/img/productos/Slingbag 3.webp', caption: 'Sling Bag' },
            { url: '/img/productos/slinbag4.jpeg', caption: 'Sling Bag' },
            { url: '/img/productos/slinbag5.jpeg', caption: 'Sling Bag' }
          ]
        },
        'hilo-plano': {
          name: 'Hilo Plano',
          description: 'Bobina de cinta de polipropileno o multifilamento con alta resistencia, ligero, liso y con usos variados. Resistente a factores ambientales.',
          features: ['Alta resistencia', 'Ligero', 'Resistente a factores ambientales'],
          uses: ['Amarre', 'Costura', 'Almacenaje'],
          gallery: [
            { url: '/img/productos/Hilo pp 1.webp', caption: 'Hilo PP' },
            { url: '/img/productos/Hilo pp 2.webp', caption: 'Hilo PP' },
            { url: '/img/productos/Hilo pp 3.webp', caption: 'Hilo PP' }
          ]
        },
        'hilo-costura': {
          name: 'Hilo de Costura',
          description: 'Hilo multifilamento de alta resistencia para costura industrial. Ideal para cerrado de sacos y aplicaciones textiles que requieren durabilidad y rendimiento superior.',
          features: ['Alta resistencia', 'Ligero', 'Multiuso'],
          uses: ['Costura', 'Amarre', 'Almacenaje'],
          gallery: [
            { url: '/img/productos/hilo-mulftifilamento.webp', caption: 'Hilo Multifilamento' },
            { url: '/img/productos/Hilo entorcelado multifilamento.webp', caption: 'Hilo entorcelado multifilamento' },
            { url: '/img/productos/hiloscostura.webp', caption: 'Hilo multifilamento reoforzado' },
            { url: '/img/colors/100.webp', caption: 'Hilos' }

          ]
        },
        'hilo-amarre': {
          name: 'Hilo de Amarre',
          description: 'Hilos hueveros y agrofil de polipropileno entorchado. Alta resistencia y superior rendimiento para amarre en agricultura, ganadería y embalaje industrial.',
          features: ['Alta resistencia', 'Superior rendimiento', 'Polipropileno'],
          uses: ['Embalaje', 'Agronomía', 'Amarre', 'Ganadería'],
          gallery: [
            { url: '/img/productos/pita agrofil (hilo de amare).webp', caption: 'Pita Agrofil' },
            { url: '/img/productos/Hilo Entorcelado pp.webp', caption: 'Hilo Entorchado PP' },
            { url: '/img/productos/Hilo entorcelado multifilamento.webp', caption: 'Hilo Entorchado Multifilamento' }
          ]
        },
        'tela-tejido': {
          name: 'Tela tejido',
          description: 'Tela tejida de Polipropileno en tubular y plano en diferentes gramajes. Con múltiples opciones a la caracterización incluyendo corte ultrasónico, laminación, gramaje, y resistencia UV. Nuestras telas se pueden adecuar a su necesidad incluyendo soluciones para ganadería, agronomía, embalaje, e industria de manufactura.',
          features: ['Embalaje', 'UV', 'Construcción', 'Ganadería', 'Agroindustria', 'Almacenaje'],
          uses: ['Ganadería', 'Agronomía', 'Embalaje', 'Industria de manufactura'],
          gallery: [
            { url: '/img/productos/tela-plana.webp', caption: 'Tela Plana' },
            { url: '/img/productos/telatubular.webp', caption: 'Tela Tubular' },
            { url: '/img/productos/telared.webp', caption: 'Tela de Red' },
            { url: '/img/productos/telared2.webp', caption: 'Tela de Red' }
          ]
        }
      };

      // Variables globales del carrusel
      let currentCarouselIndex = 0;
      let carouselImages = [];

      // Preload adjacent images for faster transitions
      function preloadImage(url) {
        if (!url) return;
        const img = new Image();
        img.src = url;
      }

      window.changeCarouselImage = function(direction) {
        if (carouselImages.length === 0) return;

        currentCarouselIndex += direction;

        // Ciclar el índice
        if (currentCarouselIndex < 0) {
          currentCarouselIndex = carouselImages.length - 1;
        } else if (currentCarouselIndex >= carouselImages.length) {
          currentCarouselIndex = 0;
        }

        updateCarouselDisplay();
      };

      function updateCarouselDisplay() {
        if (carouselImages.length === 0) return;

        const currentImage = carouselImages[currentCarouselIndex];
        const imgElement = document.getElementById('modal-carousel-img');

        // Fade out, change, fade in for smoother transition
        imgElement.style.opacity = '0.7';

        // Use requestAnimationFrame for smoother updates
        requestAnimationFrame(function() {
          // Actualizar imagen principal
          imgElement.src = currentImage.url;
          imgElement.alt = currentImage.caption;

          // Actualizar caption
          document.getElementById('modal-image-caption').textContent = currentImage.caption;

          // Actualizar contador
          document.getElementById('current-image').textContent = currentCarouselIndex + 1;

          // Fade back in
          requestAnimationFrame(function() {
            imgElement.style.opacity = '1';
          });
        });

        // Preload adjacent images for instant loading
        const nextIndex = (currentCarouselIndex + 1) % carouselImages.length;
        const prevIndex = (currentCarouselIndex - 1 + carouselImages.length) % carouselImages.length;

        if (carouselImages[nextIndex]) {
          preloadImage(carouselImages[nextIndex].url);
        }
        if (carouselImages[prevIndex]) {
          preloadImage(carouselImages[prevIndex].url);
        }

        // Actualizar thumbnails activos
        const thumbnails = document.querySelectorAll('.carousel-thumbnail');
        thumbnails.forEach((thumb, idx) => {
          if (idx === currentCarouselIndex) {
            thumb.classList.add('ring-2', 'md:ring-4', 'ring-red-500');
            thumb.classList.remove('opacity-60');
          } else {
            thumb.classList.remove('ring-2', 'md:ring-4', 'ring-red-500');
            thumb.classList.add('opacity-60');
          }
        });
      }

      window.openProductModal = function(productId) {
        // Limpiar el ID para obtener solo el identificador del producto
        const cleanProductId = productId.split('-')[0] + '-' + productId.split('-').slice(1, -1).join('-');

        const productData = PRODUCT_DATA[cleanProductId];

        if (!productData) {
          console.error('Producto no encontrado:', cleanProductId);
          return;
        }

        // Actualizar título
        document.getElementById('modal-product-title').textContent = productData.name;

        // Actualizar descripción
        document.getElementById('modal-product-description').textContent = productData.description;

        // Configurar el carrusel con las imágenes de la galería
        carouselImages = productData.gallery || [];
        currentCarouselIndex = 0;

        // Mostrar/ocultar elementos del carrusel según la cantidad de imágenes
        const thumbnailsDiv = document.getElementById('carousel-thumbnails');

        if (carouselImages.length > 1) {
          document.getElementById('carousel-prev').style.visibility = 'visible';
          document.getElementById('carousel-next').style.visibility = 'visible';
          document.getElementById('carousel-counter').style.visibility = 'visible';
          thumbnailsDiv.style.display = 'flex';
          document.getElementById('total-images').textContent = carouselImages.length;

          // Crear thumbnails con altura fija y responsive
          const thumbnailsContainer = document.getElementById('thumbnails-container');
          thumbnailsContainer.innerHTML = carouselImages.map((img, idx) => `
            <button
              onclick="currentCarouselIndex = ${idx}; updateCarouselDisplay();"
              class="carousel-thumbnail flex-shrink-0 w-12 h-12 md:w-16 md:h-16 rounded-lg overflow-hidden border-2 border-slate-300 hover:border-red-500 transition-all ${idx === 0 ? 'ring-2 md:ring-4 ring-red-500' : 'opacity-60'}"
            >
              <img src="${img.url}" alt="${img.caption}" class="w-full h-full object-cover" loading="lazy" />
            </button>
          `).join('');
        } else {
          document.getElementById('carousel-prev').style.visibility = 'hidden';
          document.getElementById('carousel-next').style.visibility = 'hidden';
          document.getElementById('carousel-counter').style.visibility = 'hidden';
          // Mantener el espacio pero vacío para que la altura sea consistente
          thumbnailsDiv.style.display = 'flex';
          document.getElementById('thumbnails-container').innerHTML = '';
        }

        // Actualizar display inicial
        updateCarouselDisplay();

        // Actualizar características
        const featuresContainer = document.getElementById('modal-product-features');
        featuresContainer.innerHTML = productData.features.map(feature => {
          const featureName = typeof feature === 'string' ? feature : feature.name;
          const featureIcon = ICON_MAP[featureName] || null;

          return `
            <div class="flex items-center gap-2 md:gap-3 bg-red-50 border border-red-200 rounded-lg px-3 md:px-4 py-2 md:py-3">
              ${featureIcon ?
                `<img src="${featureIcon}" alt="${featureName}" class="w-6 h-6 md:w-8 md:h-8 object-contain flex-shrink-0" />` :
                `<svg class="w-5 h-5 md:w-6 md:h-6 text-red-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                </svg>`
              }
              <span class="text-xs md:text-sm font-medium text-slate-700 leading-tight">${featureName}</span>
            </div>
          `;
        }).join('');

        // Actualizar usos
        const usesContainer = document.getElementById('modal-product-uses');
        usesContainer.innerHTML = productData.uses.map(use => {
          const useName = typeof use === 'string' ? use : use.name;
          const useIcon = ICON_MAP[useName] || null;

          return `
            <div class="flex items-center gap-2 md:gap-3 bg-sky-50 border border-sky-200 rounded-lg px-3 md:px-4 py-2 md:py-3">
              ${useIcon ?
                `<img src="${useIcon}" alt="${useName}" class="w-6 h-6 md:w-8 md:h-8 object-contain flex-shrink-0" />` :
                `<svg class="w-5 h-5 md:w-6 md:h-6 text-sky-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
                </svg>`
              }
              <span class="text-xs md:text-sm font-medium text-slate-700 leading-tight">${useName}</span>
            </div>
          `;
        }).join('');

        // Mostrar modal
        const modal = document.getElementById('product-detail-modal');
        modal.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
      }

      window.closeProductModal = function() {
        const modal = document.getElementById('product-detail-modal');
        modal.classList.add('hidden');
        document.body.style.overflow = '';
      }

      // Cerrar con tecla ESC y navegación con flechas
      document.addEventListener('keydown', function(e) {
        const modal = document.getElementById('product-detail-modal');
        const isModalOpen = !modal.classList.contains('hidden');

        if (!isModalOpen) return;

        if (e.key === 'Escape') {
          closeProductModal();
        } else if (e.key === 'ArrowLeft') {
          e.preventDefault();
          changeCarouselImage(-1);
        } else if (e.key === 'ArrowRight') {
          e.preventDefault();
          changeCarouselImage(1);
        }
      });
    </script>

    <!-- Script para tabs -->
    <script is:inline>
      window.switchTab = function(tabId) {
        // Ocultar todos los contenidos
        document.querySelectorAll('.tab-content').forEach(content => {
          content.classList.remove('active');
        });

        // Desactivar todos los botones
        document.querySelectorAll('.tab-button').forEach(btn => {
          btn.classList.remove('active', 'bg-red-50', 'text-red-600', 'border-red-200');
          btn.classList.add('text-slate-600', 'border-transparent');
        });

        // Activar el tab seleccionado
        const tabElement = document.getElementById(tabId);
        if (tabElement) {
          tabElement.classList.add('active');
        }

        // Activar el botón correspondiente
        const btnId = 'btn-' + tabId;
        const activeBtn = document.getElementById(btnId);
        if (activeBtn) {
          activeBtn.classList.add('active', 'bg-red-50', 'text-red-600', 'border-red-200');
          activeBtn.classList.remove('text-slate-600', 'border-transparent');
        }

        // Scroll suave al contenido, ajustando por el menú sticky
        const productosSection = document.getElementById('productos');
        if (productosSection) {
          const headerOffset = 80; // Altura del sticky header
          const elementPosition = productosSection.getBoundingClientRect().top;
          const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

          window.scrollTo({
            top: offsetPosition,
            behavior: 'smooth'
          });
        }
      }
    </script>
  </main>

  <Footer />
</Base>
